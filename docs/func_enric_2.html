<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Análisis de Enriquecimiento Funcional: Visualización y Métodos Avanzados – Biología de Sistemas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Biología de Sistemas</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./analisis_topo.html"> 
<span class="menu-text">Análisis y Topología (I)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./analisis_topo_2.html"> 
<span class="menu-text">Análisis y Topología (II)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./minimal_analysis.html"> 
<span class="menu-text">Minimal Análisis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./clustering.html"> 
<span class="menu-text">Clustering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./clustering_2.html"> 
<span class="menu-text">Clustering Enlaces</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./func_enric.html"> 
<span class="menu-text">Enriquecimiento Funcional</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./coexp.html"> 
<span class="menu-text">Coexpression Analysis</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#visualización-de-resultados-de-enriquecimiento" id="toc-visualización-de-resultados-de-enriquecimiento" class="nav-link" data-scroll-target="#visualización-de-resultados-de-enriquecimiento">Visualización de Resultados de Enriquecimiento</a>
  <ul class="collapse">
  <li><a href="#visualización-del-análisis-de-sobre-representación-ora-con-clusterprofiler" id="toc-visualización-del-análisis-de-sobre-representación-ora-con-clusterprofiler" class="nav-link" data-scroll-target="#visualización-del-análisis-de-sobre-representación-ora-con-clusterprofiler">Visualización del Análisis de Sobre-representación (ORA) con clusterProfiler</a>
  <ul class="collapse">
  <li><a href="#teoría-qué-es-el-ora" id="toc-teoría-qué-es-el-ora" class="nav-link" data-scroll-target="#teoría-qué-es-el-ora">Teoría: ¿Qué es el ORA?</a></li>
  <li><a href="#por-qué-la-visualización-es-crucial" id="toc-por-qué-la-visualización-es-crucial" class="nav-link" data-scroll-target="#por-qué-la-visualización-es-crucial">Por qué la visualización es crucial</a></li>
  <li><a href="#tipos-clave-de-visualización" id="toc-tipos-clave-de-visualización" class="nav-link" data-scroll-target="#tipos-clave-de-visualización">Tipos clave de visualización</a></li>
  <li><a href="#código-de-ejemplo-realización-de-ora-y-visualización-de-resultados" id="toc-código-de-ejemplo-realización-de-ora-y-visualización-de-resultados" class="nav-link" data-scroll-target="#código-de-ejemplo-realización-de-ora-y-visualización-de-resultados">Código de ejemplo: Realización de ORA y visualización de resultados</a></li>
  <li><a href="#explicación" id="toc-explicación" class="nav-link" data-scroll-target="#explicación">Explicación</a></li>
  </ul></li>
  <li><a href="#visualización-del-análisis-de-enriquecimiento-de-conjuntos-de-genes-gsea-con-clusterprofiler" id="toc-visualización-del-análisis-de-enriquecimiento-de-conjuntos-de-genes-gsea-con-clusterprofiler" class="nav-link" data-scroll-target="#visualización-del-análisis-de-enriquecimiento-de-conjuntos-de-genes-gsea-con-clusterprofiler">Visualización del Análisis de Enriquecimiento de Conjuntos de Genes (GSEA) con clusterProfiler</a>
  <ul class="collapse">
  <li><a href="#teoría-qué-es-el-gsea" id="toc-teoría-qué-es-el-gsea" class="nav-link" data-scroll-target="#teoría-qué-es-el-gsea">Teoría: ¿Qué es el GSEA?</a></li>
  <li><a href="#tipos-clave-de-visualización-1" id="toc-tipos-clave-de-visualización-1" class="nav-link" data-scroll-target="#tipos-clave-de-visualización-1">Tipos clave de visualización</a></li>
  <li><a href="#código-de-ejemplo-realización-de-gsea-y-visualización-de-resultados" id="toc-código-de-ejemplo-realización-de-gsea-y-visualización-de-resultados" class="nav-link" data-scroll-target="#código-de-ejemplo-realización-de-gsea-y-visualización-de-resultados">Código de ejemplo: Realización de GSEA y visualización de resultados</a></li>
  <li><a href="#explicación-1" id="toc-explicación-1" class="nav-link" data-scroll-target="#explicación-1">Explicación</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#métodos-basados-en-redes-para-el-enriquecimiento-funcional" id="toc-métodos-basados-en-redes-para-el-enriquecimiento-funcional" class="nav-link" data-scroll-target="#métodos-basados-en-redes-para-el-enriquecimiento-funcional">Métodos Basados en Redes para el Enriquecimiento Funcional</a>
  <ul class="collapse">
  <li><a href="#análisis-de-vecindad" id="toc-análisis-de-vecindad" class="nav-link" data-scroll-target="#análisis-de-vecindad">Análisis de Vecindad**</a>
  <ul class="collapse">
  <li><a href="#teoría" id="toc-teoría" class="nav-link" data-scroll-target="#teoría"><strong>Teoría</strong></a></li>
  <li><a href="#pasos-en-el-enriquecimiento-basado-en-vecindad" id="toc-pasos-en-el-enriquecimiento-basado-en-vecindad" class="nav-link" data-scroll-target="#pasos-en-el-enriquecimiento-basado-en-vecindad"><strong>Pasos en el Enriquecimiento Basado en Vecindad</strong></a></li>
  <li><a href="#código-de-ejemplo-análisis-de-vecindad-con-igraph" id="toc-código-de-ejemplo-análisis-de-vecindad-con-igraph" class="nav-link" data-scroll-target="#código-de-ejemplo-análisis-de-vecindad-con-igraph"><strong>Código de Ejemplo: Análisis de Vecindad con igraph</strong></a></li>
  <li><a href="#detección-de-módulos" id="toc-detección-de-módulos" class="nav-link" data-scroll-target="#detección-de-módulos"><strong>2.2 Detección de Módulos</strong></a></li>
  <li><a href="#enriquecimiento-basado-en-difusión" id="toc-enriquecimiento-basado-en-difusión" class="nav-link" data-scroll-target="#enriquecimiento-basado-en-difusión"><strong>2.3 Enriquecimiento Basado en Difusión</strong></a></li>
  <li><a href="#aplicación-en-el-mundo-real-1" id="toc-aplicación-en-el-mundo-real-1" class="nav-link" data-scroll-target="#aplicación-en-el-mundo-real-1"><strong>Aplicación en el Mundo Real</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#análisis-basado-en-la-topología-de-vías" id="toc-análisis-basado-en-la-topología-de-vías" class="nav-link" data-scroll-target="#análisis-basado-en-la-topología-de-vías">Análisis basado en la topología de vías</a>
  <ul class="collapse">
  <li><a href="#concepto" id="toc-concepto" class="nav-link" data-scroll-target="#concepto">Concepto</a></li>
  <li><a href="#aplicaciones" id="toc-aplicaciones" class="nav-link" data-scroll-target="#aplicaciones">Aplicaciones</a></li>
  <li><a href="#pathview-visualización-del-mapeo-de-conjuntos-de-genes-en-el-contexto-de-las-vías" id="toc-pathview-visualización-del-mapeo-de-conjuntos-de-genes-en-el-contexto-de-las-vías" class="nav-link" data-scroll-target="#pathview-visualización-del-mapeo-de-conjuntos-de-genes-en-el-contexto-de-las-vías">Pathview: Visualización del mapeo de conjuntos de genes en el contexto de las vías</a>
  <ul class="collapse">
  <li><a href="#cómo-mejora-pathview-el-análisis" id="toc-cómo-mejora-pathview-el-análisis" class="nav-link" data-scroll-target="#cómo-mejora-pathview-el-análisis">Cómo mejora Pathview el análisis</a></li>
  <li><a href="#código-de-ejemplo-usando-pathview" id="toc-código-de-ejemplo-usando-pathview" class="nav-link" data-scroll-target="#código-de-ejemplo-usando-pathview">Código de Ejemplo: Usando Pathview</a></li>
  <li><a href="#salida-visualización-de-pathview" id="toc-salida-visualización-de-pathview" class="nav-link" data-scroll-target="#salida-visualización-de-pathview">Salida: Visualización de Pathview</a></li>
  </ul></li>
  <li><a href="#análisis-de-impacto-de-vías-de-señalización-spia" id="toc-análisis-de-impacto-de-vías-de-señalización-spia" class="nav-link" data-scroll-target="#análisis-de-impacto-de-vías-de-señalización-spia">Análisis de Impacto de Vías de Señalización (SPIA)</a>
  <ul class="collapse">
  <li><a href="#objetivo-identificar-las-vías-de-señalización-afectadas" id="toc-objetivo-identificar-las-vías-de-señalización-afectadas" class="nav-link" data-scroll-target="#objetivo-identificar-las-vías-de-señalización-afectadas">Objetivo: Identificar las vías de señalización afectadas</a></li>
  <li><a href="#concepto-clave" id="toc-concepto-clave" class="nav-link" data-scroll-target="#concepto-clave">Concepto clave</a></li>
  <li><a href="#enfoque-spia" id="toc-enfoque-spia" class="nav-link" data-scroll-target="#enfoque-spia">Enfoque SPIA</a></li>
  <li><a href="#cómo-funciona-spia" id="toc-cómo-funciona-spia" class="nav-link" data-scroll-target="#cómo-funciona-spia">Cómo funciona SPIA</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#topologia" id="toc-topologia" class="nav-link" data-scroll-target="#topologia">Topologia</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Análisis de Enriquecimiento Funcional: Visualización y Métodos Avanzados</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introducción" class="level1">
<h1>Introducción</h1>
<p>Este tutorial amplía nuestra discusión previa sobre el Análisis de Sobre-representación (ORA, por sus siglas en inglés) y el Análisis de Enriquecimiento de Conjuntos de Genes (GSEA, por sus siglas en inglés). Nos enfocaremos en técnicas avanzadas para interpretar los resultados de enriquecimiento funcional mediante visualizaciones, enfoques basados en redes y métodos basados en la topología de rutas metabólicas. Finalmente, exploraremos técnicas de enriquecimiento que consideran ontologías, enfatizando las dependencias jerárquicas en los sistemas de clasificación funcional.</p>
</section>
<section id="visualización-de-resultados-de-enriquecimiento" class="level1">
<h1>Visualización de Resultados de Enriquecimiento</h1>
<section id="visualización-del-análisis-de-sobre-representación-ora-con-clusterprofiler" class="level2">
<h2 class="anchored" data-anchor-id="visualización-del-análisis-de-sobre-representación-ora-con-clusterprofiler">Visualización del Análisis de Sobre-representación (ORA) con clusterProfiler</h2>
<section id="teoría-qué-es-el-ora" class="level3">
<h3 class="anchored" data-anchor-id="teoría-qué-es-el-ora">Teoría: ¿Qué es el ORA?</h3>
<p>El ORA evalúa si conjuntos de genes predefinidos, como términos de la Ontología Genética (GO, por sus siglas en inglés) o rutas metabólicas, están sobre-representados en un conjunto de genes de consulta en comparación con un conjunto de referencia. La significancia se evalúa utilizando pruebas estadísticas como la prueba exacta de Fisher o la prueba hipergeométrica.</p>
</section>
<section id="por-qué-la-visualización-es-crucial" class="level3">
<h3 class="anchored" data-anchor-id="por-qué-la-visualización-es-crucial">Por qué la visualización es crucial</h3>
<p>La visualización de los resultados de ORA facilita la interpretación del significado biológico de las categorías enriquecidas al revelar patrones, relaciones y solapamientos. Esto puede guiar hipótesis y contextualizar hallazgos.</p>
</section>
<section id="tipos-clave-de-visualización" class="level3">
<h3 class="anchored" data-anchor-id="tipos-clave-de-visualización">Tipos clave de visualización</h3>
<ol type="1">
<li><strong>Gráfico de puntos (Dot Plot)</strong>: Muestra la significancia (valor p) y la magnitud del enriquecimiento (por ejemplo, número de genes o puntaje de enriquecimiento).</li>
<li><strong>Gráfico de barras (Bar Plot)</strong>: Destaca los términos más enriquecidos según su significancia o magnitud.</li>
<li><strong>cnetplot</strong>: Muestra las relaciones entre los genes de consulta y las categorías enriquecidas, ayudando a visualizar solapamientos.</li>
</ol>
</section>
<section id="código-de-ejemplo-realización-de-ora-y-visualización-de-resultados" class="level3">
<h3 class="anchored" data-anchor-id="código-de-ejemplo-realización-de-ora-y-visualización-de-resultados">Código de ejemplo: Realización de ORA y visualización de resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar clusterProfiler y un conjunto de datos de ejemplo</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(clusterProfiler)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>clusterProfiler v4.14.3 Learn more at https://yulab-smu.top/contribution-knowledge-mining/

Please cite:

S Xu, E Hu, Y Cai, Z Xie, X Luo, L Zhan, W Tang, Q Wang, B Liu, R Wang,
W Xie, T Wu, L Xie, G Yu. Using clusterProfiler to characterize
multiomics data. Nature Protocols. 2024, doi:10.1038/s41596-024-01020-z</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'clusterProfiler'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(org.Hs.eg.db)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: AnnotationDbi</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BiocGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, intersect, is.unsorted, lapply, Map, mapply,
    match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,
    Position, rank, rbind, Reduce, rownames, sapply, saveRDS, setdiff,
    table, tapply, union, unique, unsplit, which.max, which.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Biobase</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: IRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: S4Vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'S4Vectors'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:clusterProfiler':

    rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    findMatches</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    expand.grid, I, unname</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'IRanges'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:clusterProfiler':

    slice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'AnnotationDbi'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:clusterProfiler':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista de genes de ejemplo (genes diferencialmente expresados)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HK1"</span>, <span class="st">"HK2"</span>, <span class="st">"GCK"</span>, <span class="st">"PFKM"</span>, <span class="st">"PFKP"</span>, <span class="st">"ALDOA"</span>, <span class="st">"ALDOC"</span>, <span class="st">"TPI1"</span>, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"GAPDH"</span>, <span class="st">"PGK1"</span>, <span class="st">"ENO1"</span>, <span class="st">"PKM"</span>, <span class="st">"LDHA"</span>, <span class="st">"LDHB"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar ORA para términos de GO</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ego <span class="ot">&lt;-</span> <span class="fu">enrichGO</span>(<span class="at">gene         =</span> genes,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">keyType      =</span> <span class="st">"SYMBOL"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">OrgDb        =</span> org.Hs.eg.db,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">ont          =</span> <span class="st">"BP"</span>, <span class="co"># Proceso biológico</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">pAdjustMethod =</span> <span class="st">"BH"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">qvalueCutoff  =</span> <span class="fl">0.05</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de puntos</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(ego, <span class="at">showCategory =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ego, <span class="at">showCategory =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cnetplot</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cnetplot</span>(ego, <span class="at">showCategory =</span> <span class="dv">5</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>, <span class="at">colorEdge =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="explicación" class="level3">
<h3 class="anchored" data-anchor-id="explicación">Explicación</h3>
<ul>
<li><code>enrichGO()</code>: Realiza ORA para procesos biológicos en la Ontología Genética.</li>
<li><code>dotplot()</code>: Visualiza términos según su valor p y la proporción de genes.</li>
<li><code>cnetplot()</code>: Explora las relaciones entre genes y términos.</li>
</ul>
</section>
</section>
<section id="visualización-del-análisis-de-enriquecimiento-de-conjuntos-de-genes-gsea-con-clusterprofiler" class="level2">
<h2 class="anchored" data-anchor-id="visualización-del-análisis-de-enriquecimiento-de-conjuntos-de-genes-gsea-con-clusterprofiler">Visualización del Análisis de Enriquecimiento de Conjuntos de Genes (GSEA) con clusterProfiler</h2>
<section id="teoría-qué-es-el-gsea" class="level3">
<h3 class="anchored" data-anchor-id="teoría-qué-es-el-gsea">Teoría: ¿Qué es el GSEA?</h3>
<p>El GSEA clasifica todos los genes según una métrica (por ejemplo, cambio de expresión) y calcula puntajes de enriquecimiento (ES, por sus siglas en inglés) para conjuntos de genes predefinidos. Identifica si los genes en los extremos de una lista clasificada están enriquecidos para términos o rutas específicas.</p>
</section>
<section id="tipos-clave-de-visualización-1" class="level3">
<h3 class="anchored" data-anchor-id="tipos-clave-de-visualización-1">Tipos clave de visualización</h3>
<ol type="1">
<li><strong>Gráfico de puntaje de enriquecimiento (Enrichment Score Plot)</strong>: Visualiza el ES en la lista clasificada para un único conjunto de genes.</li>
<li><strong>Gráfico de resultados de GSEA</strong>: Resume múltiples conjuntos de genes, sus ES y el margen de enriquecimiento.</li>
<li><strong>cnetplot para GSEA</strong>: Muestra relaciones y solapamientos entre conjuntos de genes.</li>
</ol>
</section>
<section id="código-de-ejemplo-realización-de-gsea-y-visualización-de-resultados" class="level3">
<h3 class="anchored" data-anchor-id="código-de-ejemplo-realización-de-gsea-y-visualización-de-resultados">Código de ejemplo: Realización de GSEA y visualización de resultados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lista de genes clasificada de ejemplo</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(org.Hs.eg.db)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:AnnotationDbi':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:IRanges':

    collapse, desc, intersect, setdiff, slice, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:S4Vectors':

    first, intersect, rename, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Biobase':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:BiocGenerics':

    combine, intersect, setdiff, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of glycolysis-related genes (expand this list as necessary)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>glycolysis_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HK1"</span>, <span class="st">"HK2"</span>, <span class="st">"GCK"</span>, <span class="st">"PFKM"</span>, <span class="st">"PFKP"</span>, <span class="st">"ALDOA"</span>, <span class="st">"ALDOC"</span>, <span class="st">"TPI1"</span>, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"GAPDH"</span>, <span class="st">"PGK1"</span>, <span class="st">"ENO1"</span>, <span class="st">"PKM"</span>, <span class="st">"LDHA"</span>, <span class="st">"LDHB"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve all human gene symbols from org.Hs.eg.db</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>all_genes <span class="ot">&lt;-</span> <span class="fu">keys</span>(org.Hs.eg.db, <span class="at">keytype =</span> <span class="st">"SYMBOL"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly sample 485 genes from the full list (excluding glycolysis genes)</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>random_genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(all_genes[<span class="sc">!</span>all_genes <span class="sc">%in%</span> glycolysis_genes], <span class="dv">485</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine glycolysis-related genes at the start of the list</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>combined_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(glycolysis_genes, random_genes)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign higher FC values for glycolysis genes (1 to 3) and lower for others (-3 to 1)</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>fc_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(<span class="fu">length</span>(glycolysis_genes), <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">3</span>),  <span class="co"># Higher FC for glycolysis genes</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">runif</span>(<span class="fu">length</span>(random_genes), <span class="at">min =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">max =</span> <span class="fl">1.5</span>))    <span class="co"># Lower FC for others</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the gene list with fold changes and sort so decreasing</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>gene_list <span class="ot">&lt;-</span> <span class="fu">setNames</span>(fc_values, combined_genes)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>gene_list <span class="ot">&lt;-</span> <span class="fu">sort</span>(gene_list, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Realizar GSEA</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>gsea <span class="ot">&lt;-</span> <span class="fu">gseGO</span>(<span class="at">geneList     =</span> gene_list,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">OrgDb        =</span> org.Hs.eg.db,</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">keyType      =</span> <span class="st">"SYMBOL"</span>,</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">ont          =</span> <span class="st">"BP"</span>,</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">pvalueCutoff =</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>using 'fgsea' for GSEA analysis, please cite Korotkevich et al (2019).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>preparing geneSet collections...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>GSEA analysis...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in fgseaMultilevel(pathways = pathways, stats = stats, minSize =
minSize, : For some of the pathways the P-values were likely overestimated. For
such pathways log2err is set to NA.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in fgseaMultilevel(pathways = pathways, stats = stats, minSize =
minSize, : For some pathways, in reality P-values are less than 1e-10. You can
set the `eps` argument to zero for better estimation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>leading edge analysis...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>done...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de puntaje de enriquecimiento</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gseaplot</span>(gsea, <span class="at">geneSetID =</span> <span class="dv">1</span>, <span class="at">title =</span> gsea<span class="sc">$</span>Description[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cnetplot para GSEA</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cnetplot</span>(gsea, <span class="at">showCategory =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="explicación-1" class="level3">
<h3 class="anchored" data-anchor-id="explicación-1">Explicación</h3>
<ul>
<li><code>gseGO()</code>: Realiza GSEA para términos de la Ontología Genética.</li>
<li><code>gseaplot()</code>: Resalta los picos de ES, mostrando dónde ocurre el enriquecimiento.</li>
<li><code>cnetplot()</code>: Visualiza solapamientos entre términos.</li>
</ul>
</section>
</section>
</section>
<section id="métodos-basados-en-redes-para-el-enriquecimiento-funcional" class="level1">
<h1>Métodos Basados en Redes para el Enriquecimiento Funcional</h1>
<p>El enriquecimiento funcional basado en redes aprovecha las relaciones y la topología de las redes biológicas para obtener información sobre cómo los conjuntos de genes de consulta interactúan dentro del sistema global. Las redes ayudan a contextualizar los genes o proteínas en vías, complejos y sistemas de interacción, proporcionando una visión más integral de los procesos biológicos.</p>
<section id="análisis-de-vecindad" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-vecindad">Análisis de Vecindad**</h2>
<section id="teoría" class="level3">
<h3 class="anchored" data-anchor-id="teoría"><strong>Teoría</strong></h3>
<p>El análisis de vecindad se centra en el entorno local de la red que rodea a un gen o conjunto de genes de consulta. La idea es identificar funciones enriquecidas dentro de la “vecindad” de un conjunto de nodos en una red.</p>
<ul>
<li><strong>Vecindad Local</strong>: Los nodos directamente conectados al conjunto de consulta (vecinos de primer grado).</li>
<li><strong>Vecindad Extendida</strong>: Nodos dentro de un radio definido (por ejemplo, vecinos de segundo o tercer grado).</li>
<li><strong>Implicaciones Funcionales</strong>: Los genes con funciones biológicas similares suelen estar estrechamente conectados, como lo respalda el principio de “culpabilidad por asociación” en las redes biológicas.</li>
</ul>
</section>
<section id="pasos-en-el-enriquecimiento-basado-en-vecindad" class="level3">
<h3 class="anchored" data-anchor-id="pasos-en-el-enriquecimiento-basado-en-vecindad"><strong>Pasos en el Enriquecimiento Basado en Vecindad</strong></h3>
<ol type="1">
<li><strong>Definir el Conjunto de Consulta</strong>:
<ul>
<li>Lista de genes de entrada (por ejemplo, genes diferencialmente expresados).</li>
<li>Definir el radio o profundidad de la vecindad.</li>
</ul></li>
<li><strong>Construir la Red</strong>:
<ul>
<li>Fuente: Bases de datos públicas como STRING, BioGRID, o datos experimentales personalizados.</li>
<li>Nodos: Proteínas o genes.</li>
<li>Aristas: Interacciones como unión física o co-expresión.</li>
</ul></li>
<li><strong>Extraer la Vecindad</strong>:
<ul>
<li>Identificar los vecinos de primer grado o expandir más allá.</li>
<li>Construir una subred.</li>
</ul></li>
<li><strong>Anotación Funcional</strong>:
<ul>
<li>Realizar análisis de enriquecimiento utilizando pruebas estadísticas.</li>
</ul></li>
<li><strong>Visualizar los Resultados</strong>:
<ul>
<li>Resaltar el conjunto de consulta y los términos enriquecidos en la red.</li>
</ul></li>
</ol>
<hr>
</section>
<section id="código-de-ejemplo-análisis-de-vecindad-con-igraph" class="level3">
<h3 class="anchored" data-anchor-id="código-de-ejemplo-análisis-de-vecindad-con-igraph"><strong>Código de Ejemplo: Análisis de Vecindad con igraph</strong></h3>
<p>Aquí se muestra cómo realizar un análisis de vecindad utilizando una red de ejemplo y datos funcionales simulados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'igraph'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    as_data_frame, groups, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:IRanges':

    union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:S4Vectors':

    union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:BiocGenerics':

    normalize, path, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:clusterProfiler':

    simplify</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    decompose, spectrum</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Create a sparser network using Erdos-Renyi model</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set seed for reproducibility</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>  <span class="co"># Number of nodes</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">erdos.renyi.game</span>(<span class="at">n =</span> n, <span class="at">p =</span> <span class="fl">0.2</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)  <span class="co"># 20 nodes, 20% chance of edge between any two nodes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `erdos.renyi.game()` was deprecated in igraph 0.8.0.
ℹ Please use `sample_gnp()` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Assign character names to the nodes</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"G"</span>, <span class="dv">1</span><span class="sc">:</span>n, <span class="at">sep =</span> <span class="st">""</span>)  <span class="co"># Assign names G1, G2, ..., G20</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Visualize the complete network</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">vertex.label.color =</span> <span class="st">"black"</span>, <span class="at">vertex.size =</span> <span class="dv">30</span>, </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="st">"skyblue"</span>, <span class="at">main =</span> <span class="st">"Sparse Gene Network (Erdos-Renyi)"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.label =</span> <span class="fu">V</span>(g)<span class="sc">$</span>name)  <span class="co"># Use character labels for the nodes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Select two or three query genes (nodes) by their names</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>query_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"G1"</span>, <span class="st">"G5"</span>, <span class="st">"G10"</span>)  <span class="co"># Use character labels for simplicity</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Extract the neighborhoods for each query gene (first-degree neighbors)</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>neighborhoods <span class="ot">&lt;-</span> <span class="fu">lapply</span>(query_genes, <span class="cf">function</span>(gene) {</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">neighbors</span>(g, gene)  <span class="co"># Extract first-degree neighbors</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Create an induced subgraph for each query gene and it's neighbours</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Command: induced_subgraph</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: combine subgraphs if possible</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 8: Visualize the graph with the subgraph genes highlighted</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Hint - need to override the following:</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>color </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<hr>
<section id="aplicación-en-el-mundo-real" class="level4">
<h4 class="anchored" data-anchor-id="aplicación-en-el-mundo-real"><strong>Aplicación en el Mundo Real</strong></h4>
<p>El análisis de vecindad puede identificar vías o procesos biológicos enriquecidos en la vecindad de un gen asociado a enfermedades. Ejemplos incluyen: - <strong>Investigación sobre el cáncer</strong>: Descubrir vías enriquecidas en la vecindad de oncogenes. - <strong>Neurobiología</strong>: Analizar redes alrededor de genes clave en enfermedades neurodegenerativas.</p>
<hr>
</section>
</section>
<section id="detección-de-módulos" class="level3">
<h3 class="anchored" data-anchor-id="detección-de-módulos"><strong>2.2 Detección de Módulos</strong></h3>
<section id="teoría-1" class="level4">
<h4 class="anchored" data-anchor-id="teoría-1"><strong>Teoría</strong></h4>
<p>Los módulos (o clústeres) son subestructuras dentro de una red que están estrechamente conectadas, a menudo representando unidades funcionales como complejos proteicos o vías de señalización. Al identificar módulos y probar su enriquecimiento, podemos descubrir patrones funcionales ocultos.</p>
<ul>
<li><strong>Definición</strong>: Un módulo es un grupo de nodos con una mayor densidad de aristas dentro del grupo en comparación con el exterior.</li>
<li><strong>Relevancia Biológica</strong>: Los módulos frecuentemente corresponden a vías biológicas o complejos.</li>
</ul>
</section>
<section id="algoritmos-de-clustering-para-detección-de-módulos" class="level4">
<h4 class="anchored" data-anchor-id="algoritmos-de-clustering-para-detección-de-módulos"><strong>Algoritmos de Clustering para Detección de Módulos</strong></h4>
<ol type="1">
<li><strong>Método Louvain</strong>:
<ul>
<li>Maximiza la modularidad (una medida de la estructura comunitaria).</li>
<li>Adecuado para redes de gran escala.</li>
</ul></li>
<li><strong>Algoritmo Walktrap</strong>:
<ul>
<li>Identifica comunidades basándose en caminatas aleatorias cortas.</li>
<li>Eficaz para redes más pequeñas.</li>
</ul></li>
<li><strong>Otros Métodos</strong>:
<ul>
<li>Infomap, Propagación de Etiquetas o Clustering Espectral.</li>
</ul></li>
</ol>
<hr>
</section>
<section id="pasos-en-el-enriquecimiento-basado-en-módulos" class="level4">
<h4 class="anchored" data-anchor-id="pasos-en-el-enriquecimiento-basado-en-módulos"><strong>Pasos en el Enriquecimiento Basado en Módulos</strong></h4>
<ol type="1">
<li>Identificar los módulos en la red.</li>
<li>Extraer los nodos dentro de cada módulo.</li>
<li>Realizar análisis de enriquecimiento para los términos funcionales de cada módulo.</li>
</ol>
<hr>
</section>
<section id="código-de-ejemplo-detección-de-módulos-con-igraph" class="level4">
<h4 class="anchored" data-anchor-id="código-de-ejemplo-detección-de-módulos-con-igraph"><strong>Código de Ejemplo: Detección de Módulos con igraph</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect modules using Louvain</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>louvain_modules <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(g)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign colors to modules</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>color <span class="ot">&lt;-</span> louvain_modules<span class="sc">$</span>membership</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the network with modules</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">vertex.label.color =</span> <span class="st">"black"</span>, <span class="at">vertex.size =</span> <span class="dv">30</span>, </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.color =</span> <span class="fu">V</span>(g)<span class="sc">$</span>color, <span class="at">main =</span> <span class="st">"Louvain Modules"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract nodes from a module</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Your turn! How can we get the genes for each of the modules, and use them to look for functional enrichment?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="enriquecimiento-basado-en-difusión" class="level3">
<h3 class="anchored" data-anchor-id="enriquecimiento-basado-en-difusión"><strong>2.3 Enriquecimiento Basado en Difusión</strong></h3>
<section id="teoría-2" class="level4">
<h4 class="anchored" data-anchor-id="teoría-2"><strong>Teoría</strong></h4>
<p>Los métodos de difusión propagan la información desde los nodos de consulta hacia sus vecinos en la red, simulando la propagación de señales biológicas. Este enfoque resalta los nodos conectados indirectamente que pueden contribuir a vías funcionales.</p>
<ul>
<li><strong>Aplicaciones</strong>:
<ul>
<li>Priorizar genes candidatos a enfermedades.</li>
<li>Encontrar miembros novedosos de vías.</li>
</ul></li>
<li><strong>Métodos</strong>: Caminatas aleatorias o técnicas de difusión de calor.</li>
</ul>
<hr>
</section>
<section id="código-de-ejemplo-difusión-por-caminata-aleatoria" class="level4">
<h4 class="anchored" data-anchor-id="código-de-ejemplo-difusión-por-caminata-aleatoria"><strong>Código de Ejemplo: Difusión por Caminata Aleatoria</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load igraph library</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple graph (you can modify this for your graph)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">erdos.renyi.game</span>(<span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.3</span>, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the starting node for the random walk (e.g., node 1)</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>start_node <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform random walk with restart</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>random_walk_with_restart <span class="ot">&lt;-</span> <span class="cf">function</span>(graph, start_node, <span class="at">steps =</span> <span class="dv">1000</span>, <span class="at">walks =</span> <span class="dv">10</span>, <span class="at">restart_prob =</span> <span class="fl">0.1</span>) {</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  node_count <span class="ot">&lt;-</span> <span class="fu">vcount</span>(graph)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  visited <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, node_count)  <span class="co"># Vector to keep track of visits to each node</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (walk <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>walks) {</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    current_node <span class="ot">&lt;-</span> start_node</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>steps) {</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>      visited[current_node] <span class="ot">&lt;-</span> visited[current_node] <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Mark the node as visited</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Decide whether to restart or continue the random walk</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> restart_prob) {</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>        current_node <span class="ot">&lt;-</span> start_node  <span class="co"># Restart from the starting node</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>        neighbors <span class="ot">&lt;-</span> <span class="fu">neighbors</span>(graph, current_node)  <span class="co"># Get neighbors of current node</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(neighbors) <span class="sc">==</span> <span class="dv">0</span>) <span class="cf">break</span>  <span class="co"># Stop if no neighbors are left</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>        current_node <span class="ot">&lt;-</span> <span class="fu">sample</span>(neighbors, <span class="dv">1</span>)  <span class="co"># Choose a random neighbor to move to</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate probabilities</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> visited <span class="sc">/</span> <span class="fu">sum</span>(visited)  <span class="co"># Normalize the visits to get probabilities</span></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(prob)</span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the random walk with restart simulation</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> <span class="fu">random_walk_with_restart</span>(g, start_node, <span class="at">steps =</span> <span class="dv">1000</span>, <span class="at">walks =</span> <span class="dv">10</span>, <span class="at">restart_prob =</span> <span class="fl">0.1</span>)</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalize the probabilities to create more distinct color contrasts</span></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> (probabilities <span class="sc">-</span> <span class="fu">min</span>(probabilities)) <span class="sc">/</span> (<span class="fu">max</span>(probabilities) <span class="sc">-</span> <span class="fu">min</span>(probabilities))</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Set node colors: use a reversed color palette (red for high probability, blue for low probability)</span></span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">heat.colors</span>(<span class="fu">length</span>(probabilities)))[<span class="fu">floor</span>(probabilities <span class="sc">*</span> <span class="fu">length</span>(probabilities)) <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Highlight the start node with a different color (e.g., green)</span></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>color[start_node] <span class="ot">&lt;-</span> <span class="st">"green"</span></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Increase the size of the start node for emphasis</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">vcount</span>(g) <span class="sc">==</span> start_node, <span class="dv">30</span>, <span class="dv">20</span>)</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the graph with improved color contrast</span></span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">vertex.label =</span> <span class="cn">NA</span>, <span class="at">main =</span> <span class="st">"Random Walk with Restart Diffusion on Graph"</span>, </span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>     <span class="at">vertex.size =</span> <span class="fu">V</span>(g)<span class="sc">$</span>size, <span class="at">vertex.color =</span> <span class="fu">V</span>(g)<span class="sc">$</span>color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="func_enric_2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="aplicación-en-el-mundo-real-1" class="level3">
<h3 class="anchored" data-anchor-id="aplicación-en-el-mundo-real-1"><strong>Aplicación en el Mundo Real</strong></h3>
<ul>
<li><strong>Descubrimiento de medicamentos</strong>: Identificación de dianas indirectos para fármacos mediante la propagación de genes de enfermedades a través de una red de interacción proteína-proteína.</li>
<li><strong>Anotación funcional</strong>: Asignación de funciones a genes no caracterizados basándose en sus perfiles de difusión.</li>
</ul>
</section>
</section>
</section>
<section id="análisis-basado-en-la-topología-de-vías" class="level1">
<h1>Análisis basado en la topología de vías</h1>
<section id="concepto" class="level2">
<h2 class="anchored" data-anchor-id="concepto">Concepto</h2>
<p>El análisis basado en la topología de vías explora la estructura y la conectividad de las vías biológicas para identificar vías enriquecidas o alteradas en un conjunto de genes. Incorpora la conectividad de los genes y las proteínas dentro de las vías para mejorar la comprensión de los procesos biológicos.</p>
<p><strong>Idea clave</strong>: En lugar de centrarse solo en genes individuales, este enfoque evalúa cómo los genes están posicionados e interactúan dentro de las vías biológicas, considerando las relaciones entre los nodos (genes) y los bordes (interacciones).</p>
</section>
<section id="aplicaciones" class="level2">
<h2 class="anchored" data-anchor-id="aplicaciones">Aplicaciones</h2>
<ul>
<li><p><strong>Identificación de vías alteradas en enfermedades</strong>: Este enfoque se puede usar para descubrir vías biológicas alteradas asociadas a enfermedades, analizando cambios en las interacciones y expresión génica.</p></li>
<li><p><strong>Priorización de vías para el desarrollo de fármacos</strong>: El análisis de la topología de vías puede guiar la identificación de posibles objetivos para fármacos, evaluando los nodos clave y las regiones regulatorias de las vías.</p></li>
</ul>
<hr>
</section>
<section id="pathview-visualización-del-mapeo-de-conjuntos-de-genes-en-el-contexto-de-las-vías" class="level2">
<h2 class="anchored" data-anchor-id="pathview-visualización-del-mapeo-de-conjuntos-de-genes-en-el-contexto-de-las-vías">Pathview: Visualización del mapeo de conjuntos de genes en el contexto de las vías</h2>
<p><strong>Pathview</strong> es un paquete de R que permite la visualización basada en vías y el análisis de conjuntos de genes. Mapea los datos de expresión u otros tipos de datos a los mapas de vías (por ejemplo, KEGG) y permite a los usuarios visualizar dónde están ubicados los genes dentro de la vía. Esto ayuda a entender si los cambios en la expresión génica están concentrados en partes clave de la vía o si están más dispersos.</p>
<section id="cómo-mejora-pathview-el-análisis" class="level3">
<h3 class="anchored" data-anchor-id="cómo-mejora-pathview-el-análisis">Cómo mejora Pathview el análisis</h3>
<ul>
<li><p><strong>Mapas de Vías</strong>: Pathview superpone los datos de expresión génica a los mapas de vías y resalta los genes según su posición en la vía. Esto permite visualizar si los genes de consulta están en regiones importantes de la vía (como puntos de control metabólicos o nodos regulatorios).</p></li>
<li><p><strong>Posicionamiento de Genes</strong>: Pathview ayuda a evaluar si los genes topológicamente importantes (aquellos en nodos centrales o hubs regulatorios) son afectados por el conjunto de genes de consulta.</p></li>
<li><p><strong>Expresión Diferencial</strong>: Pathview también se integra con los datos de expresión diferencial para resaltar genes sobreexpresados y subexpresados a lo largo de la red de la vía.</p></li>
</ul>
</section>
<section id="código-de-ejemplo-usando-pathview" class="level3">
<h3 class="anchored" data-anchor-id="código-de-ejemplo-usando-pathview">Código de Ejemplo: Usando Pathview</h3>
<p>A continuación se muestra un ejemplo de cómo usar el paquete <strong>Pathview</strong> en R para visualizar datos de expresión génica en un mapa de vías:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalar y cargar el paquete pathview</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>BiocManager<span class="sc">::</span><span class="fu">install</span>(<span class="st">"pathview"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>'getOption("repos")' replaces Bioconductor standard repositories, see
'help("repositories", package = "BiocManager")' for details.
Replacement repositories:
    CRAN: https://cloud.r-project.org</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Bioconductor version 3.20 (BiocManager 1.30.25), R 4.4.2 (2024-10-31)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Installation paths not writeable, unable to update packages
  path: /usr/lib/R/library
  packages:
    boot, class, cluster, codetools, foreign, KernSmooth, lattice, MASS,
    Matrix, mgcv, nlme, nnet, rpart, spatial, survival
  path: /usr/local/lib/R/site-library
  packages:
    optparse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Old packages: 'curl', 'ggtangle', 'RSQLite'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pathview)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>##############################################################################
Pathview is an open source software package distributed under GNU General
Public License version 3 (GPLv3). Details of GPLv3 is available at
http://www.gnu.org/licenses/gpl-3.0.html. Particullary, users are required to
formally cite the original Pathview paper (not just mention it) in publications
or products. For details, do citation("pathview") within R.

The pathview downloads and uses KEGG data. Non-academic uses may require a KEGG
license agreement (details at http://www.kegg.jp/kegg/legal.html).
##############################################################################</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gse16873.d)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>pv.out <span class="ot">&lt;-</span> <span class="fu">pathview</span>(<span class="at">gene.data =</span> gse16873.d[, <span class="dv">1</span>], <span class="at">pathway.id =</span> <span class="st">"04110"</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">species =</span> <span class="st">"hsa"</span>, <span class="at">out.suffix =</span> <span class="st">"gse16873"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>'select()' returned 1:1 mapping between keys and columns</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Info: Working in directory /home/jim/BS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Info: Writing image file hsa04110.gse16873.png</code></pre>
</div>
</div>
</section>
<section id="salida-visualización-de-pathview" class="level3">
<h3 class="anchored" data-anchor-id="salida-visualización-de-pathview">Salida: Visualización de Pathview</h3>
<p>Pathview genera un mapa visual de la vía, con los genes resaltados según su nivel de expresión y su posición en la vía. Esto permite ver claramente las regiones de la vía que están más afectadas por el conjunto de genes. Escribe la salida a disco</p>
</section>
</section>
<section id="análisis-de-impacto-de-vías-de-señalización-spia" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-impacto-de-vías-de-señalización-spia">Análisis de Impacto de Vías de Señalización (SPIA)</h2>
<p><strong>Análisis de Impacto de Vías de Señalización (SPIA)</strong> evalúa el impacto de los genes diferencialmente expresados (DEGs) sobre las vías biológicas. Combina la topología de la vía con la expresión génica para determinar el impacto general de un conjunto de genes en las vías, considerando tanto los efectos directos como los indirectos.</p>
<section id="objetivo-identificar-las-vías-de-señalización-afectadas" class="level3">
<h3 class="anchored" data-anchor-id="objetivo-identificar-las-vías-de-señalización-afectadas">Objetivo: Identificar las vías de señalización afectadas</h3>
<p>El objetivo del SPIA es identificar qué vías de señalización están más afectadas por los cambios en la expresión génica. Este método es útil para comprender el contexto biológico más amplio de los cambios en la expresión génica, especialmente en estados patológicos.</p>
</section>
<section id="concepto-clave" class="level3">
<h3 class="anchored" data-anchor-id="concepto-clave">Concepto clave</h3>
<p>SPIA integra la estructura de la vía (topología) con los datos de expresión génica para calcular un puntaje de impacto para cada vía. La topología de la vía y la expresión diferencial de los genes determinan qué tan significativos son los cambios en la vía.</p>
</section>
<section id="enfoque-spia" class="level3">
<h3 class="anchored" data-anchor-id="enfoque-spia">Enfoque SPIA</h3>
<ol type="1">
<li><p><strong>Cambios en la Expresión Génica</strong>: La expresión diferencial (por ejemplo, el cambio de log fold) representa cómo los genes se ven afectados en el conjunto de genes de consulta. Estos cambios pueden ser positivos (sobrerregulados) o negativos (subregulados).</p></li>
<li><p><strong>Topología de la Vía</strong>: La topología de la vía representa las interacciones moleculares (nodos: genes, bordes: interacciones) dentro de la vía. Esta estructura dicta cómo los cambios en la expresión génica se propagan a través de la vía.</p></li>
<li><p><strong>Propagación de la Expresión</strong>: Los cambios en la expresión génica se propagan a través de la red, afectando a los genes y vías descendentes. Un gen que se encuentra centralmente en la vía tiene un mayor impacto en la actividad global de la vía que un gen ubicado en la periferia.</p></li>
</ol>
</section>
<section id="cómo-funciona-spia" class="level3">
<h3 class="anchored" data-anchor-id="cómo-funciona-spia">Cómo funciona SPIA</h3>
<section id="paso-1-identificar-los-genes-diferencialmente-expresados-degs" class="level4">
<h4 class="anchored" data-anchor-id="paso-1-identificar-los-genes-diferencialmente-expresados-degs">Paso 1: Identificar los Genes Diferencialmente Expresados (DEGs)</h4>
<p>El primer paso es identificar los genes de consulta que muestran cambios significativos en la expresión. Por lo general, estos genes provienen de un análisis de expresión diferencial, donde los cambios en el log fold indican genes sobreexpresados o subexpresados.</p>
</section>
<section id="paso-2-cálculo-de-la-topología-y-el-impacto" class="level4">
<h4 class="anchored" data-anchor-id="paso-2-cálculo-de-la-topología-y-el-impacto">Paso 2: Cálculo de la Topología y el Impacto</h4>
<ul>
<li><p><strong>Topología de la Vía</strong>: Los mapas de la vía (por ejemplo, KEGG o Reactome) proporcionan la estructura de las interacciones génicas.</p></li>
<li><p><strong>Propagación de la Expresión</strong>: Los cambios de expresión se propagan a lo largo de la red. Si un gen en la vía se ve afectado, los genes descendentes también se impactan según su posición en la red.</p></li>
</ul>
</section>
<section id="paso-3-puntaje-de-impacto-de-la-vía" class="level4">
<h4 class="anchored" data-anchor-id="paso-3-puntaje-de-impacto-de-la-vía">Paso 3: Puntaje de Impacto de la Vía</h4>
<p>Cada vía recibe un <strong>Puntaje de Impacto</strong> basado en la expresión diferencial y la estructura de la vía. El puntaje de impacto tiene en cuenta tanto:</p>
<ul>
<li><strong>Impacto Directo</strong>: El impacto de los DEGs que afectan directamente a los nodos de la vía.</li>
<li><strong>Impacto Indirecto</strong>: Las conexiones de la vía (bordes) que influyen en la actividad general de la vía.</li>
</ul>
<p>El análisis basado en la topología de vías es un enfoque poderoso para comprender cómo los genes están posicionados e interactúan dentro de las vías biológicas. Al usar herramientas como <strong>Pathview</strong> y <strong>SPIA</strong>, los investigadores pueden descubrir vías alteradas en enfermedades, priorizar vías para el desarrollo de fármacos y obtener información sobre el contexto biológico más amplio de los cambios en la expresión génica.</p>
</section>
</section>
</section>
</section>
<section id="topologia" class="level1">
<h1>Topologia</h1>
<p>Para anadir - mientras tanto, puedes usar topGO en vez de clusterProfiler sobre tus genes HPO - notas diferencias? Hay manera de dar resultados parecidos?</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>